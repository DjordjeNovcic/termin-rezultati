<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8">
  <title>Mečevi</title>
  <script type="module" src="firebase.js"></script>
  <style>
    body { font-family: Arial; max-width: 600px; margin: auto; padding: 20px; }
    li { padding: 6px; border-bottom: 1px solid #ccc; }
  </style>
</head>
<body>

<h1>Poslednji mečevi</h1>
<ul id="list"></ul>

<script type="module">
  import { onValue } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";

  const playersRef = window.dbRef("players");
  const matchesRef = window.dbRef("matches");

  let players = {};

  onValue(playersRef, snap => players = snap.val() || {});

  onValue(matchesRef, (snap) => {
    const data = snap.val() || {};
    const list = document.getElementById("list");
    list.innerHTML = "";

    Object.values(data)
      .sort((a,b)=> b.time - a.time)
      .forEach(m => {
        const name = players[m.winner]?.name || "Nepoznat";
        const date = new Date(m.time).toLocaleString();
        list.innerHTML += `<li>${date}: <b>${name}</b> pobedio</li>`;
      });
  });
</script>

</body>
</html>
